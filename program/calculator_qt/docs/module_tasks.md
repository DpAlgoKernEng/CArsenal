# QT C++17 计算器 - 子模块任务清单

基于架构文档，将项目拆分为以下可独立实施的子模块，按优先级排序（P0 最高，P3 最低）。

## 优先级定义
- **P0**: 核心功能，必须首先实现，否则其他模块无法工作
- **P1**: 重要功能，增强用户体验和基本可用性
- **P2**: 扩展功能，提升产品完整性和竞争力
- **P3**: 优化与辅助功能，用于完善和优化

## P0 核心模块（第一阶段）

### 1. 项目骨架与构建系统
- **任务**: 创建 CMakeLists.txt、目录结构、基础依赖配置
- **输出**: 可编译的空项目，包含 Qt 6.5 和 C++17 配置
- **依赖**: 无
- **预估工时**: 2 小时

### 2. 数学表达式解析引擎
- **任务**: 实现词法分析器、语法分析器（调度场算法）、AST 节点类
- **输出**: 能够解析 "2+3*(4-1)" 等基本表达式并生成 AST
- **依赖**: 项目骨架
- **预估工时**: 8 小时

### 3. 表达式求值引擎
- **任务**: 实现 AST 遍历求值，支持四则运算、括号、基本函数（sin, cos, sqrt）
- **输出**: 能够计算解析后的表达式并返回浮点数结果
- **依赖**: 表达式解析引擎
- **预估工时**: 6 小时

### 4. 标准模式 UI（Qt Quick/QML）
- **任务**: 创建标准模式 QML 界面，包含数字按钮、运算符按钮、显示屏
- **输出**: 可交互的 UI，能够输入表达式并显示结果
- **依赖**: 表达式求值引擎
- **预估工时**: 6 小时

### 5. 应用入口与模式控制器
- **任务**: 实现 main.cpp、Application 类、模式切换逻辑
- **输出**: 可启动的应用，支持在标准模式与其他模式间切换
- **依赖**: 标准模式 UI
- **预估工时**: 4 小时

## P1 重要模块（第二阶段）

### 6. 科学计算器模式
- **任务**: 扩展表达式引擎支持三角函数、指数、对数、常数（π, e）；创建科学模式 QML 界面
- **输出**: 科学计算器模式可用，支持高级数学运算
- **依赖**: 标准模式、表达式引擎
- **预估工时**: 10 小时

### 7. 程序员模式
- **任务**: 实现进制转换（二、八、十、十六）、位运算；创建程序员模式 QML 界面
- **输出**: 程序员模式可用，支持进制转换和位运算
- **依赖**: 标准模式
- **预估工时**: 8 小时

### 8. 历史记录系统
- **任务**: 实现历史管理器、SQLite 存储、历史面板 QML 组件
- **输出**: 能够记录每次计算，支持查看、重用历史条目
- **依赖**: 表达式引擎、UI
- **预估工时**: 6 小时

### 9. 变量管理系统
- **任务**: 实现变量管理器、变量存储、变量面板 QML 组件
- **输出**: 支持定义变量（如 x=5），在表达式中引用变量
- **依赖**: 表达式引擎、历史系统
- **预估工时**: 6 小时

## P2 扩展模块（第三阶段）

### 10. 单位换算器
- **任务**: 实现单位换算引擎，支持长度、质量、温度等常见单位
- **输出**: 单位换算功能，可在科学模式中调用
- **依赖**: 科学计算器模式
- **预估工时**: 8 小时

### 11. 矩阵运算引擎
- **任务**: 实现矩阵类、基本运算（加、乘、求逆、行列式）
- **输出**: 支持矩阵输入和运算
- **依赖**: 科学计算器模式
- **预估工时**: 12 小时

### 12. 自定义函数支持
- **任务**: 实现函数管理器、用户自定义函数定义与存储
- **输出**: 用户可定义新函数（如 f(x)=x^2+sin(x)）并在表达式中调用
- **依赖**: 变量管理系统
- **预估工时**: 8 小时

### 13. 插件系统框架
- **任务**: 设计插件 API、插件管理器、插件加载机制
- **输出**: 插件系统骨架，可加载简单插件
- **依赖**: 核心引擎
- **预估工时**: 10 小时

## P3 优化与辅助模块（第四阶段）

### 14. 高精度数学库集成
- **任务**: 集成 MPFR/GMP 库，提供任意精度算术
- **输出**: 支持高精度计算，避免浮点误差
- **依赖**: 表达式求值引擎
- **预估工时**: 6 小时

### 15. 缓存管理器
- **任务**: 实现表达式结果缓存，提升重复计算性能
- **输出**: 缓存系统，可配置缓存大小和过期策略
- **依赖**: 表达式引擎
- **预估工时**: 4 小时

### 16. 主题管理器与国际化
- **任务**: 实现主题切换（亮色/暗色）、多语言支持（Qt Linguist）
- **输出**: 可切换主题和语言的应用
- **依赖**: UI 层
- **预估工时**: 6 小时

### 17. 错误处理与日志系统
- **任务**: 集成 spdlog，实现统一错误处理和日志记录
- **输出**: 完善的错误提示和日志文件
- **依赖**: 所有模块
- **预估工时**: 4 小时

### 18. 性能优化
- **任务**: 实现并行求值、内存池、编译器优化配置
- **输出**: 性能提升的表达式引擎
- **依赖**: 表达式引擎、缓存管理器
- **预估工时**: 8 小时

## 实施路线图

### 第一阶段（MVP - 最小可行产品）
1. 项目骨架与构建系统
2. 数学表达式解析引擎
3. 表达式求值引擎
4. 标准模式 UI
5. 应用入口与模式控制器

**目标**: 一个能进行基本四则运算的标准计算器，可跨平台运行。

### 第二阶段（功能完整）
6. 科学计算器模式
7. 程序员模式
8. 历史记录系统
9. 变量管理系统

**目标**: 支持三种模式，具备历史记录和变量管理功能。

### 第三阶段（扩展增强）
10. 单位换算器
11. 矩阵运算引擎
12. 自定义函数支持
13. 插件系统框架

**目标**: 成为功能强大的科学计算器，支持矩阵、单位换算和自定义函数。

### 第四阶段（优化完善）
14. 高精度数学库集成
15. 缓存管理器
16. 主题管理器与国际化
17. 错误处理与日志系统
18. 性能优化

**目标**: 企业级可生产性，高性能，优秀的用户体验。

## 依赖关系图

```
项目骨架 → 表达式解析 → 表达式求值 → 标准模式 UI → 应用入口
    ↓
科学模式 ←───┐
程序员模式 ←─┘
    ↓
历史记录 → 变量管理 → 自定义函数
    ↓
单位换算 → 矩阵运算
    ↓
插件系统
    ↓
高精度数学 → 缓存管理 → 性能优化
    ↓
主题管理 → 国际化 → 错误处理
```

## 下一步行动

1. 为每个子模块创建详细的实施计划文档
2. 创建项目骨架（CMakeLists.txt 和目录结构）
3. 开始实现 P0 模块，逐步构建 MVP

---
*文档版本: 1.0*
*最后更新: 2026-01-12*